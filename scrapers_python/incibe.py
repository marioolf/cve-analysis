import http.client
from bs4 import BeautifulSoup

def check_cve_in_incibe(cve_id):
    #url completa: https://www.incibe.es/incibe-cert/alerta-temprana/vulnerabilidades/{cve_id}
    conn = http.client.HTTPSConnection("www.incibe.es")
    conn.request("GET", f"/incibe-cert/alerta-temprana/vulnerabilidades/{cve_id}")
    
    response = conn.getresponse()
    
    data = response.read()
    conn.close()
    
    if response.status == 200:
        soup = BeautifulSoup(data, 'html.parser')
        div = soup.find('div', class_='date float-right')
        
        if div:
            return div.get_text(strip=True)
        else:
            return "No almacenada"
    else:
        return f"Error: {response.status} {response.reason}"

if __name__ == "__main__":
    import sys
    if len(sys.argv) != 2:
        print("Uso: python3 incibe.py <CVE_ID>")
    else:
        cve_id = sys.argv[1]
        result = check_cve_in_incibe(cve_id)
        print(result)
